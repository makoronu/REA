# HTML構造調査

## やること

### Step 0: SSR/CSR判定（フェッチモード決定）
1. Contaboからrequests（プロキシ経由）で詳細ページを1件取得
2. HTMLに物件情報（価格・住所等）が含まれるか確認
   - **含まれる → SSR**: `Fetcher(use_selenium=False)` を使用
   - **含まれない → CSR**: `Fetcher(use_selenium=True)` を使用（Seleniumヘッドレス）
3. 判定結果を記録（以降の全工程でこのモードを使用）

### Step 1: 一覧ページ調査
1. 検索結果ページ（一覧）を開き、HTMLを保存・調査
   - 物件カード要素、リンク要素、ページネーション要素
2. 特記事項を記録（Refererヘッダー必須、Cookie必須等）

### Step 2: 詳細ページ調査
1. 物件詳細ページを開き、HTMLを保存・調査
   - タイトル、価格、情報テーブル（dl or table）、会社情報
2. 物件種別ごとにサンプル取得（土地・戸建・マンション）

### Step 3: 物件種別判定方法の確認
1. URLに種別情報が含まれるか確認（例: `/kodate/` `/mansion/`）
   - **含まれる**: URL正規表現で判定（PROPERTY_TYPE_FROM_URL）
   - **含まれない**: HTML内ラベルの差異で判定（`detect_property_type_from_html`）
2. 一覧ページURLのパラメータで種別が判定可能か確認
3. 判定方法を記録

### Step 4: 物件種別コードの実機確認（必須）
1. サイトの検索フォームHTMLから物件種別コードを**実際に取得**
   - フォームの`input[name*=種別パラメータ]`のvalue属性を全数列挙
   - 例: `ptm[]=0101`（土地）、`ptm[]=0102`（一戸建）、`ptm[]=0103`（マンション）
2. **推測でコードを作らない**（0101→0201→0301のような規則性を仮定しない）
3. 取得したコードで**各種別ごとに一覧ページを1件取得**し、物件カードが返ることを確認
4. 確認したコード対応表を記録

## 完了条件
- [ ] SSR/CSR判定完了（フェッチモード決定）
- [ ] 一覧/詳細ページの構造を把握した
- [ ] テーブル形式を特定した（dl or table）
- [ ] サンプルHTMLを保存した
- [ ] 物件種別判定方法を決定した
- [ ] サイト固有の注意点を記録した（Referer/Cookie等）

## 次 → selectors.md
