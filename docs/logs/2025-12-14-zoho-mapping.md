# 2025-12-14 ZOHO マッピング作業ログ

## 問題発覚

ZOHOからREAへのインポートで、ENUM型フィールドにZOHOの生テキストをそのまま入れていた。

### 発覚した問題
- property_type: 「【売戸建】中古戸建」→ 変換せずそのまま
- sales_status: 「販売準備」「販売中」→ 変換せずそのまま
- publication_status: 「非公開」「公開」→ 変換せずそのまま
- 用途地域（use_district）: マッピング自体していない
- その他多数のENUMフィールド: 確認すらしていない

## 反省

### やらかしたこと
1. ENUM型フィールドのマッピングを完全に怠った
2. インポート後の検証をしなかった
3. stagingテーブルの意味を理解していなかった（Transform工程をスキップ）
4. 「動いた」と「正しく動いた」を混同した

### 本来あるべきフロー
```
[ZOHO API] → [Extract] → [staging保存] → [Transform] → [Load] → [Validate]
```
Transform工程（値変換）をやらなかったのが根本原因。

## 洗い出し結果

### REAのENUM型フィールド（全20個）

**propertiesテーブル（6個）**
- sales_status: 準備中, 販売中, 商談中, 成約済み, 販売終了, 販売準備
- publication_status: 非公開, 会員公開, 公開
- price_status: 1:確定, 2:相談, 3:応相談
- current_status: 1:空家, 2:居住中, 3:賃貸中, 9:その他
- delivery_timing: 1:即時, 2:相談, 3:期日指定
- transaction_type: 1:売主, 2:代理, 3:専任媒介, 4:一般媒介, 5:専属専任, 6:買取

**building_infoテーブル（9個）**
- building_structure: 1:木造, 2:鉄骨造, 3:RC造, 4:SRC造, 5:軽量鉄骨, 6:ALC, 9:その他
- area_measurement_type: 1:壁芯, 2:内法, 3:登記簿
- direction: 1:北〜8:北西
- room_type: 1:R〜6:その他
- management_type: 1:自主管理, 2:管理会社委託, 3:一部委託, 9:その他
- management_association: 0:無, 1:有
- building_manager: 1:常駐, 2:日勤, 3:巡回, 4:自主管理, 9:無
- parking_availability: 1:無〜5:近隣(有料)
- parking_type: 1:平置き, 2:機械式, 3:立体, 9:その他

**land_infoテーブル（5個）**
- land_area_measurement: 1:公簿, 2:実測, 3:私測
- use_district: 1:第一種低層住居専用〜12:工業専用
- land_rights: 1:所有権, 2:借地権, 3:定期借地権, 4:地上権
- setback: 0:不要, 1:要, 2:セットバック済
- land_transaction_notice: 0:不要, 1:要, 2:届出済

### ZOHOフィールドの実データ（ユニーク値）

**field6: 取引態様**
- 1714件: 仲介
- 386件: 専任
- 138件: 一般
- 64件: 売主
- 37件: (NULL)
- 27件: 買取
- 4件: 賃貸

**field7: 販売状況/公開状況**
- 2234件: 終了非公開
- 93件: 公開
- 22件: 賃貸（貸出中）
- 6件: 賃貸（終了非公開）
- 4件: 非公開（決済予定）
- 4件: 未公開
- 4件: 非公開（契約決済予定）
- 3件: 非公開（契約予定）

**field8: 物件種別**
- 2000件: 【売戸建】中古戸建
- 256件: 【売地】売地
- 27件: 【売戸建】新築戸建
- 20件: (NULL)
- 12件: 【売建物全部】店舗付住宅
- 9件: 【賃貸居住】一戸建
- 8件: 【賃貸居住】アパート
- 7件: 【売建物全部】店舗
- 7件: 【賃貸事業】その他
- 6件: 【売建物全部】アパート
- 4件: 【売建物全部】倉庫
- 3件: 【賃貸事業】一戸建
- 3件: 【売建物全部】その他
- 2件: 【売地】建付土地
- 2件: 【売建物一部】店舗
- 1件: 【売建物全部】旅館
- 1件: 【売マン】中古マンション
- 1件: 【売建物全部】事務所
- 1件: 【売建物全部】ビル

**field24: 現況**
- 1392件: 空家
- 549件: 居住中
- 185件: 更地
- 146件: (NULL)
- 54件: 賃貸中
- 43件: 上物有
- 1件: 未完成

**field25: 用途地域**
- 654件: 第二種中高層住居専用
- 568件: 第一種住居
- 485件: 第一種低層住居専用
- 170件: 無指定
- 145件: 第二種住居
- 114件: (NULL)
- 65件: 工業
- 53件: 準工業
- 50件: 第一種中高層住居専用
- 31件: 近隣商業
- 22件: 商業
- 13件: 第二種低層住居専用

**field39: 方向**
- 514件: 北
- 425件: 南
- 275件: 西
- 273件: 東
- 221件: 北西
- 191件: 北東
- 191件: 南東
- 159件: 南西
- 121件: (NULL)

**field42: 土地権利**
- 2256件: 所有権
- 113件: (NULL)
- 1件: 旧法地上

**field43: セットバック**
- 1237件: 不要
- 1125件: (NULL)
- 7件: 要
- 1件: 届出中

## 次のアクション

1. 全ENUMフィールドのマッピング表を作成
2. mapper.pyを全面修正
3. 既存データをクリア
4. 再インポート実行
5. データ検証
6. UI確認（Selenium）
