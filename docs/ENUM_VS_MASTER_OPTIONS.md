# ENUM型 vs master_options 比較表

**作成日**: 2025-12-14
**目的**: 二重管理状態の整理

---

## 問題の概要

REAのDBには2つのマスターデータ管理方式が混在している：
1. **ENUM型**: PostgreSQLのENUM型として定義（テーブルのカラム型）
2. **master_options**: master_categoriesとmaster_optionsテーブルで管理

両者の値が異なるため、どちらを正とするか決定が必要。

---

## 比較表

### 1. publication_status（公開状況）

| ENUM型 | master_options |
|--------|----------------|
| 非公開 | 0:自社HPのみ |
| 会員公開 | 1:HOME'S公開 |
| 公開 | - |

**→ 完全に異なる。どちらを使うか決定必要。**

---

### 2. current_status（現況）

| ENUM型 | master_options |
|--------|----------------|
| 1:空家 | 1:更地/空室/空家/利用中 |
| 2:居住中 | 2:古屋あり/居住中/空 |
| 3:賃貸中 | 3:賃貸中 |
| 9:その他 | 4:未完成 |
| - | 10:古屋あり更地引渡可 |

**→ 異なる。master_optionsの方が詳細。**

---

### 3. transaction_type（取引態様）

| ENUM型 | master_options |
|--------|----------------|
| 1:売主 | 1:売主 |
| 2:代理 | 2:代理 |
| 3:専任媒介 | 3:仲介(専任) |
| 4:一般媒介 | 4:仲介(一般) |
| 5:専属専任 | 5:仲介(専属) |
| 6:買取 | - |

**→ 表記揺れあり。ENUMに「買取」がある。**

---

### 4. building_structure（建物構造）

| ENUM型 | master_options |
|--------|----------------|
| 1:木造 | 1:木造 |
| 2:鉄骨造 | 2:ブロック |
| 3:RC造 | 3:鉄骨造 |
| 4:SRC造 | 4:RC |
| 5:軽量鉄骨 | 5:SRC |
| 6:ALC | 6:PC |
| 9:その他 | 7:HPC |
| - | 9:その他 |
| - | 10:軽量鉄骨 |
| - | 11:ALC |
| - | 12:鉄筋ブロック |
| - | 13:CFT |

**→ コード番号の意味が全く異なる！master_optionsの方が詳細。**

---

### 5. use_district（用途地域）

| ENUM型 | master_options |
|--------|----------------|
| 1:第一種低層住居専用 | 1:第一種低層住居専用 |
| 2:第二種低層住居専用 | 2:第二種中高層住居専用 |
| 3:第一種中高層住居専用 | 3:第二種住居 |
| 4:第二種中高層住居専用 | 4:近隣商業 |
| 5:第一種住居 | 5:商業 |
| 6:第二種住居 | 6:準工業 |
| 7:準住居 | 7:工業 |
| 8:近隣商業 | 8:工業専用 |
| 9:商業 | 10:第二種低層住居専用 |
| 10:準工業 | 11:第一種中高層住居専用 |
| 11:工業 | 12:第一種住居 |
| 12:工業専用 | 13:準住居 |
| - | 14:田園住居地域 |
| - | 99:無指定 |

**→ コード番号の割り当てが異なる！master_optionsに「99:無指定」がある。**

---

### 6. land_rights（土地権利）

| ENUM型 | master_options |
|--------|----------------|
| 1:所有権 | 1:所有権 |
| 2:借地権 | 2:旧法地上 |
| 3:定期借地権 | 3:旧法賃借 |
| 4:地上権 | 4:普通地上 |
| - | 5:定期地上 |
| - | 6:普通賃借 |
| - | 7:定期賃借 |
| - | 8:一時使用 |
| - | 21:地上権 |
| - | 22:定期借地 |
| - | 23:賃借権 |
| - | 99:その他 |

**→ 完全に異なる。master_optionsの方が詳細。**

---

### 7. setback（セットバック）

| ENUM型 | master_options |
|--------|----------------|
| 0:不要 | 1:無 |
| 1:要 | 2:有 |
| 2:セットバック済 | - |

**→ コード番号が異なる。ENUMに「セットバック済」がある。**

---

### 8. property_type（物件種別）

ENUM型は存在しない（TEXT型）。master_optionsのみ。

**master_options（60種類）:**
- 1101:売地, 1102:借地権譲渡, 1103:底地権譲渡
- 1201:新築戸建, 1202:中古戸建, ...
- 1301:新築マンション, 1302:中古マンション, ...
- 1401:売店舗(建物全部), ...
- 3101:賃貸マンション, 3102:賃貸アパート, ...

---

## 一致しているもの

以下のフィールドはENUM型とmaster_optionsが概ね一致：

- **price_status**: 1:相談/確定/入札（表記揺れあり）
- **delivery_timing**: 1:即時, 2:相談, 3:期日指定
- **orientation/direction**: 1:北〜8:北西

---

## 決定が必要な事項

1. **どちらを正とするか？**
   - ENUM型を正としてmaster_optionsを修正？
   - master_optionsを正としてENUM型を修正？
   - master_optionsに統一してENUM型を廃止？

2. **ZOHOインポート時のマッピング先**
   - 現在のENUM型にマッピング？
   - master_optionsに合わせる？

---

## 推奨案

**master_optionsを正とし、ENUM型を将来的に廃止する方向で統一する。**

理由：
- master_optionsの方が詳細で柔軟
- マルチテナント対応（会社別カスタマイズ可能）
- コードの追加・変更がDB変更不要
