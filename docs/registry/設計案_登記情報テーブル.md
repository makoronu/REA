# 登記情報テーブル設計案（改訂版）

> **調査日**: 2025-12-15
> **参考**: 法務省「不動産登記のABC」、司法書士事務所解説資料

## 登記事項証明書とは

**登記事項証明書（登記簿謄本）** = 法務局が発行する不動産の権利関係を証明する公的書類

### 4つのセクション構成

```
┌─────────────────────────────────────────────────────────────┐
│ 【表題部】物理的情報                                         │
│   土地: 所在、地番、地目、地積                               │
│   建物: 所在、家屋番号、種類、構造、床面積                   │
├─────────────────────────────────────────────────────────────┤
│ 【権利部 甲区】所有権に関する事項                            │
│   順位番号 | 登記の目的 | 受付年月日・受付番号 | 原因 | 権利者 │
│   1        | 所有権保存 | 平成17年11月5日 第12345号 | - | 山田太郎 │
│   2        | 所有権移転 | 令和3年5月20日 第98765号 | 売買 | 鈴木花子 │
├─────────────────────────────────────────────────────────────┤
│ 【権利部 乙区】所有権以外の権利                              │
│   順位番号 | 登記の目的 | 受付年月日・受付番号 | 債権額 | 利息 | 抵当権者 │
│   1        | 抵当権設定 | 令和3年5月20日 第98766号 | 4,000万円 | 年2.60% | 南北銀行 │
├─────────────────────────────────────────────────────────────┤
│ 【共同担保目録】（複数物件を担保にしている場合）              │
│   番号 | 担保の目的である権利の表示                          │
└─────────────────────────────────────────────────────────────┘
```

### 重要な概念

- **順位番号**: 登記申請の受付順。乙区では順位が担保権の優先度を決定
- **受付番号**: 法務局での受付時に付与される一意の番号（例: 第12345号）
- **下線**: 抹消・変更された事項には下線が引かれる（履歴として残る）

## 実務での利用（3つの書類への転記）

登記情報は以下の3つの書類に転記される。**これらに必要な項目を網羅する必要がある。**

---

### 1. 重要事項説明書（宅建業法35条書面）

契約前に宅建士が説明する書類。登記簿から転記する項目：

| 項目 | 内容 | DBカラム |
|------|------|---------|
| **不動産の表示** | | |
| 所在 | 北海道○○郡○○町字○○ | `location` |
| 地番 | 1番地 | `chiban` |
| 地目 | 宅地 | `land_category` |
| 地積 | 300.00㎡ | `land_area` |
| 家屋番号 | 1番 | `building_number` |
| 種類 | 居宅 | `building_type` |
| 構造 | 木造瓦葺2階建 | `building_structure` |
| 床面積 | 1階80.00㎡、2階70.00㎡ | `floor_area_*` |
| **登記された権利** | | |
| 所有権 | 所有者名義、共有の場合は全員 | 甲区エントリ |
| 抵当権 | 債権額、抵当権者 | 乙区エントリ |
| その他権利 | 地上権、賃借権、地役権、仮登記、差押等 | 乙区エントリ |

**重要**: 仮登記・差押があると物件所有ができない可能性あり

---

### 2. 売買契約書

契約時に作成する書類。登記簿から転記する項目：

| 項目 | 記載例 | DBカラム |
|------|-------|---------|
| **物件の表示** | | |
| 土地 | 所在・地番・地目・地積 | `location`, `chiban`, `land_category`, `land_area` |
| 建物 | 所在・家屋番号・種類・構造・床面積 | `location`, `building_number`, `building_type`, `building_structure`, `floor_area_*` |
| **所有権移転** | | |
| 売主 | 現在の所有者（登記名義人） | 甲区エントリ（最新の有効なもの） |
| **負担消除** | | |
| 抵当権 | 抹消予定の抵当権一覧 | 乙区エントリ（is_active=true） |

---

### 3. 登記申請書

法務局に提出する書類。

#### 所有権移転登記申請書

| 項目 | 記載例 | DBカラム |
|------|-------|---------|
| 登記の目的 | 所有権移転 | - |
| 原因 | 令和6年12月1日 売買 | 新規入力 |
| 権利者（買主） | 住所・氏名 | 新規入力 |
| 義務者（売主） | 住所・氏名 | 甲区エントリ（現所有者） |
| **不動産の表示** | 登記簿どおり正確に | 表題部 |

#### 抵当権設定登記申請書

| 項目 | 記載例 | DBカラム |
|------|-------|---------|
| 登記の目的 | 抵当権設定 | - |
| 原因 | 令和6年12月1日金銭消費貸借同日設定 | `cause`, `cause_date` |
| 債権額 | 金4,000万円 | `debt_amount` |
| 利息 | 年2.60％（年365日日割計算） | `interest_rate` |
| 損害金 | 年14.5％ | `damage_rate` |
| 債務者 | 住所・氏名 | `debtor_name`, `debtor_address` |
| 抵当権者 | 住所・氏名 | `mortgagee_name`, `mortgagee_address` |
| **不動産の表示** | 登記簿どおり正確に | 表題部 |

#### 抵当権抹消登記申請書

| 項目 | 記載例 | DBカラム |
|------|-------|---------|
| 登記の目的 | ○番抵当権抹消 | 乙区エントリ `rank_number` |
| 原因 | 令和6年12月1日 解除（または弁済） | 新規入力 |
| 権利者 | 所有者（住所・氏名） | 甲区エントリ（現所有者） |
| 義務者 | 抵当権者（住所・氏名） | 乙区エントリ `mortgagee_*` |
| **不動産の表示** | 登記簿どおり正確に | 表題部 |

---

### 必要項目チェックリスト

設計案が以下の項目を全て保持できるか確認：

**表題部（property_registries）**
- [x] 所在（location）
- [x] 地番（chiban）
- [x] 地目（land_category）
- [x] 地積（land_area）
- [x] 家屋番号（building_number）
- [x] 種類（building_type）
- [x] 構造（building_structure）
- [x] 床面積（floor_area_*）

**甲区（registry_kou_entries）**
- [x] 順位番号（rank_number）
- [x] 登記の目的（purpose）
- [x] 受付年月日（reception_date）
- [x] 受付番号（reception_number）
- [x] 原因（cause）
- [x] 原因日付（cause_date）
- [x] 所有者氏名（owner_name）
- [x] 所有者住所（owner_address）
- [x] 持分（ownership_ratio）
- [x] 抹消フラグ（is_active）

**乙区（registry_otsu_entries）**
- [x] 順位番号（rank_number）
- [x] 登記の目的（purpose）
- [x] 受付年月日（reception_date）
- [x] 受付番号（reception_number）
- [x] 原因（cause）
- [x] 原因日付（cause_date）
- [x] 債権額（debt_amount）
- [x] 利息（interest_rate）
- [x] 損害金（damage_rate）
- [x] 債務者（debtor_name, debtor_address）
- [x] 抵当権者（mortgagee_name, mortgagee_address）
- [x] 極度額（maximum_amount）※根抵当権用
- [x] 債権の範囲（debt_scope）※根抵当権用
- [x] 共同担保目録番号（joint_collateral_number）
- [x] 抹消フラグ（is_active）

## 現状の問題

現在の `property_registries` テーブルは以下の問題がある：

1. **甲区・乙区が1件ずつしか持てない**
   - 実際は所有権移転の履歴（複数）、複数の抵当権が存在する

2. **順位番号がない**
   - 甲区・乙区は順位番号で優先順位を管理する

3. **受付番号がない**
   - 各登記には法務局の受付番号がある

4. **抹消情報がない**
   - 登記は抹消されても履歴として残る

---

## 実際の登記簿謄本の構造

```
┌─────────────────────────────────────────────────┐
│ 不動産登記簿（土地 or 建物）                      │
├─────────────────────────────────────────────────┤
│ 【表題部】物理的情報（1件）                       │
│   ・所在、地番/家屋番号、地目/種類、面積          │
├─────────────────────────────────────────────────┤
│ 【権利部 甲区】所有権に関する事項（複数件）       │
│   順位1: 所有権保存 Aさん                        │
│   順位2: 所有権移転 Bさん（売買）                │
│   順位3: 所有権移転 Cさん（相続）← 現所有者      │
├─────────────────────────────────────────────────┤
│ 【権利部 乙区】所有権以外の権利（複数件）         │
│   順位1: 抵当権設定 銀行A 債権額1000万円         │
│   順位2: 根抵当権設定 銀行B 極度額2000万円       │
│   順位1-1: 抵当権移転 銀行C（債権譲渡）          │
└─────────────────────────────────────────────────┘
```

---

## 新テーブル設計

### ER図

```
properties (1)
    │
    └──< property_registries (N) 【表題部】
              │
              ├──< registry_kou_entries (N) 【甲区】
              │
              └──< registry_otsu_entries (N) 【乙区】
```

### 1. property_registries（表題部）

土地または建物の物理的情報。1物件に対して複数筆の土地・複数棟の建物がありうる。

```sql
CREATE TABLE property_registries (
    id SERIAL PRIMARY KEY,
    property_id INTEGER NOT NULL REFERENCES properties(id),
    registry_type VARCHAR(10) NOT NULL CHECK (registry_type IN ('土地', '建物')),

    -- === 共通項目 ===
    location VARCHAR(500) NOT NULL,          -- 所在

    -- === 土地用 ===
    chiban VARCHAR(100),                     -- 地番
    land_category VARCHAR(50),               -- 地目（宅地、田、畑、山林等）
    land_area NUMERIC(12,2),                 -- 地積（㎡）

    -- === 建物用 ===
    building_number VARCHAR(100),            -- 家屋番号
    building_type VARCHAR(100),              -- 種類（居宅、店舗、共同住宅等）
    building_structure VARCHAR(100),         -- 構造（木造瓦葺2階建等）
    floor_area_1f NUMERIC(10,2),             -- 1階床面積
    floor_area_2f NUMERIC(10,2),             -- 2階床面積
    floor_area_3f NUMERIC(10,2),             -- 3階床面積
    floor_area_b1 NUMERIC(10,2),             -- 地下1階床面積
    floor_area_other JSONB,                  -- その他階 [{floor: "4階", area: 50.5}]
    floor_area_total NUMERIC(10,2),          -- 床面積合計
    built_date DATE,                         -- 新築年月日

    -- === 表題部の変更履歴用 ===
    title_cause VARCHAR(200),                -- 原因（分筆、合筆、増築等）
    title_cause_date DATE,                   -- 原因日付

    -- === メタ情報 ===
    registry_office VARCHAR(100),            -- 管轄法務局
    certified_date DATE,                     -- 登記簿取得日
    raw_pdf_path VARCHAR(500),               -- 原本PDFパス
    notes TEXT,

    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW(),

    CONSTRAINT valid_land CHECK (
        registry_type != '土地' OR chiban IS NOT NULL
    ),
    CONSTRAINT valid_building CHECK (
        registry_type != '建物' OR building_number IS NOT NULL
    )
);

CREATE INDEX idx_registries_property ON property_registries(property_id);
CREATE INDEX idx_registries_type ON property_registries(registry_type);
```

### 2. registry_kou_entries（甲区：所有権に関する事項）

所有権の移転履歴を順位番号で管理。

```sql
CREATE TABLE registry_kou_entries (
    id SERIAL PRIMARY KEY,
    registry_id INTEGER NOT NULL REFERENCES property_registries(id) ON DELETE CASCADE,

    -- === 登記の基本情報 ===
    rank_number VARCHAR(20) NOT NULL,        -- 順位番号（"1", "2", "付記1号"等）
    purpose VARCHAR(100) NOT NULL,           -- 登記の目的
    reception_date DATE,                     -- 受付年月日
    reception_number VARCHAR(50),            -- 受付番号（例: 第12345号）

    -- === 権利者情報 ===
    owner_name VARCHAR(200) NOT NULL,        -- 所有者氏名（共有の場合カンマ区切り可）
    owner_address TEXT,                      -- 所有者住所
    ownership_ratio VARCHAR(100),            -- 持分（例: "2分の1", "持分3分の2"）

    -- === 原因 ===
    cause VARCHAR(100),                      -- 原因（売買、相続、贈与、時効取得等）
    cause_date DATE,                         -- 原因日付
    cause_detail TEXT,                       -- 原因詳細（遺産分割協議等）

    -- === 抹消情報 ===
    is_active BOOLEAN NOT NULL DEFAULT TRUE, -- 現在有効か（抹消されていないか）
    deletion_date DATE,                      -- 抹消日
    deletion_reception_number VARCHAR(50),   -- 抹消の受付番号

    notes TEXT,
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_kou_registry ON registry_kou_entries(registry_id);
CREATE INDEX idx_kou_active ON registry_kou_entries(is_active);
```

**登記の目的（purpose）の例：**
- 所有権保存
- 所有権移転
- 所有権一部移転
- 共有者全員持分全部移転
- 所有権移転請求権仮登記
- 所有権登記名義人住所変更

### 3. registry_otsu_entries（乙区：所有権以外の権利）

抵当権、根抵当権、地上権、賃借権等を管理。

```sql
CREATE TABLE registry_otsu_entries (
    id SERIAL PRIMARY KEY,
    registry_id INTEGER NOT NULL REFERENCES property_registries(id) ON DELETE CASCADE,

    -- === 登記の基本情報 ===
    rank_number VARCHAR(20) NOT NULL,        -- 順位番号（"1", "2", "1-1"等）
    purpose VARCHAR(100) NOT NULL,           -- 登記の目的
    reception_date DATE,                     -- 受付年月日
    reception_number VARCHAR(50),            -- 受付番号

    -- === 抵当権用 ===
    debt_amount BIGINT,                      -- 債権額（円）
    interest_rate VARCHAR(50),               -- 利息（例: "年2.475%"）
    damage_rate VARCHAR(50),                 -- 損害金（例: "年14%"）
    debtor_name VARCHAR(200),                -- 債務者
    debtor_address TEXT,                     -- 債務者住所
    mortgagee_name VARCHAR(200),             -- 抵当権者
    mortgagee_address TEXT,                  -- 抵当権者住所

    -- === 根抵当権用 ===
    maximum_amount BIGINT,                   -- 極度額（円）
    debt_scope TEXT,                         -- 債権の範囲

    -- === 地上権・賃借権等用 ===
    right_holder_name VARCHAR(200),          -- 権利者
    right_holder_address TEXT,               -- 権利者住所
    right_purpose TEXT,                      -- 目的（例: "堅固建物所有"）
    right_scope TEXT,                        -- 範囲
    right_duration VARCHAR(100),             -- 存続期間（例: "30年"）
    rent_amount VARCHAR(100),                -- 賃料（賃借権の場合）

    -- === 原因 ===
    cause VARCHAR(100),                      -- 原因（金銭消費貸借、設定契約等）
    cause_date DATE,                         -- 原因日付

    -- === 共同担保 ===
    joint_collateral_number VARCHAR(50),     -- 共同担保目録番号

    -- === 抹消情報 ===
    is_active BOOLEAN NOT NULL DEFAULT TRUE, -- 現在有効か
    deletion_date DATE,                      -- 抹消日
    deletion_reception_number VARCHAR(50),   -- 抹消の受付番号

    notes TEXT,
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_otsu_registry ON registry_otsu_entries(registry_id);
CREATE INDEX idx_otsu_active ON registry_otsu_entries(is_active);
CREATE INDEX idx_otsu_purpose ON registry_otsu_entries(purpose);
```

**登記の目的（purpose）の例：**
- 抵当権設定
- 根抵当権設定
- 抵当権移転
- 抵当権変更
- 地上権設定
- 賃借権設定
- 地役権設定
- 質権設定

### 具体的な記載例（調査結果より）

**甲区の例：**
```
順位番号: 1
登記の目的: 所有権保存
受付年月日: 平成17年11月5日
受付番号: 第12345号
権利者: 東京都○○区○○町1-2-3
        山田 太郎

順位番号: 2
登記の目的: 所有権移転
受付年月日: 令和3年5月20日
受付番号: 第98765号
原因: 令和3年5月1日売買
権利者: 東京都○○区○○町4-5-6
        鈴木 花子
```

**乙区の例：**
```
順位番号: 1
登記の目的: 抵当権設定
受付年月日: 令和3年5月20日
受付番号: 第98766号
原因: 令和3年5月20日金銭消費貸借同日設定
債権額: 金4,000万円
利息: 年2.60%（年365日の日割計算）
損害金: 年14.5%
債務者: 東京都○○区○○町4-5-6
        鈴木 花子
抵当権者: 東京都千代田区○○町1-1-1
          株式会社南北銀行
```

---

## マスターテーブル

### 登記目的マスター

```sql
CREATE TABLE m_registry_purposes (
    id SERIAL PRIMARY KEY,
    section VARCHAR(10) NOT NULL CHECK (section IN ('甲区', '乙区')),
    code VARCHAR(50) NOT NULL,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    display_order INTEGER NOT NULL DEFAULT 0,
    is_active BOOLEAN NOT NULL DEFAULT TRUE,

    UNIQUE(section, code)
);

-- 甲区
INSERT INTO m_registry_purposes (section, code, name, display_order) VALUES
('甲区', 'ownership_preservation', '所有権保存', 1),
('甲区', 'ownership_transfer', '所有権移転', 2),
('甲区', 'ownership_partial_transfer', '所有権一部移転', 3),
('甲区', 'co_owner_transfer', '共有者全員持分全部移転', 4),
('甲区', 'provisional_registration', '所有権移転請求権仮登記', 5),
('甲区', 'address_change', '所有権登記名義人住所変更', 6),
('甲区', 'name_change', '所有権登記名義人氏名変更', 7);

-- 乙区
INSERT INTO m_registry_purposes (section, code, name, display_order) VALUES
('乙区', 'mortgage', '抵当権設定', 1),
('乙区', 'revolving_mortgage', '根抵当権設定', 2),
('乙区', 'mortgage_transfer', '抵当権移転', 3),
('乙区', 'mortgage_change', '抵当権変更', 4),
('乙区', 'superficies', '地上権設定', 5),
('乙区', 'lease', '賃借権設定', 6),
('乙区', 'easement', '地役権設定', 7),
('乙区', 'pledge', '質権設定', 8);
```

### 地目マスター

```sql
CREATE TABLE m_land_categories (
    id SERIAL PRIMARY KEY,
    code VARCHAR(20) NOT NULL UNIQUE,
    name VARCHAR(50) NOT NULL,
    description TEXT,
    display_order INTEGER NOT NULL DEFAULT 0
);

INSERT INTO m_land_categories (code, name, display_order) VALUES
('residential', '宅地', 1),
('field', '田', 2),
('dry_field', '畑', 3),
('ranch', '牧場', 4),
('forest', '山林', 5),
('salt_field', '塩田', 6),
('mineral_spring', '鉱泉地', 7),
('pond', '池沼', 8),
('wilderness', '原野', 9),
('graveyard', '墓地', 10),
('shrine', '境内地', 11),
('canal', '運河用地', 12),
('waterway', '水道用地', 13),
('reservoir', '用悪水路', 14),
('embankment', '堤', 15),
('well', '井溝', 16),
('levee', '保安林', 17),
('park', '公園', 18),
('road', '公衆用道路', 19),
('miscellaneous', '雑種地', 20);
```

---

## 移行計画

### Phase 1: 新テーブル作成
```sql
-- 新テーブルを作成（既存テーブルは残す）
CREATE TABLE property_registries_v2 (...);
CREATE TABLE registry_kou_entries (...);
CREATE TABLE registry_otsu_entries (...);
```

### Phase 2: データ移行
```sql
-- 既存データを新構造に移行
INSERT INTO property_registries_v2 (...)
SELECT ... FROM property_registries;

-- 甲区エントリを作成（既存の所有者情報から）
INSERT INTO registry_kou_entries (...)
SELECT ... FROM property_registries WHERE owner_name IS NOT NULL;

-- 乙区エントリを作成（既存の抵当権情報から）
INSERT INTO registry_otsu_entries (...)
SELECT ... FROM property_registries WHERE mortgage_holder IS NOT NULL;
```

### Phase 3: API・UI更新
- 新構造に対応したAPI作成
- 甲区・乙区の複数エントリ対応UI

### Phase 4: 旧テーブル削除
```sql
DROP TABLE property_registries;
ALTER TABLE property_registries_v2 RENAME TO property_registries;
```

---

## UI設計案

```
┌─────────────────────────────────────────────────────────┐
│ 登記情報                                    [+ 登記を追加] │
├─────────────────────────────────────────────────────────┤
│ 土地 (2筆)                                              │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 【表題部】北海道○○郡○○町字○○ 1番地              │ │
│ │ 地目: 宅地 ｜ 地積: 250.50㎡                        │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ 【甲区】所有権                      [+ 甲区を追加]  │ │
│ │  順位1 所有権保存 山田太郎 (2020/01/15)             │ │
│ │  順位2 所有権移転 鈴木花子 売買 (2023/05/20) ← 現在 │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ 【乙区】抵当権等                    [+ 乙区を追加]  │ │
│ │  順位1 抵当権設定 ○○銀行 債権額2,000万円          │ │
│ │  順位2 根抵当権設定 △△信金 極度額1,000万円        │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ 建物 (1棟)                                              │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 【表題部】同所 家屋番号1番                          │ │
│ │ 種類: 居宅 ｜ 構造: 木造瓦葺2階建 ｜ 床面積: 120㎡  │ │
│ │ ...                                                 │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

---

## 質問事項

1. **履歴の完全性**: 抹消済みの甲区・乙区も全て保持するか、現在有効なもののみで良いか？

2. **共同担保目録**: 乙区で参照する共同担保目録を別テーブルで管理するか？

3. **PDFインポート**: 登記簿PDFの自動パース機能は必要か？（OCR + 構造化）

4. **仮登記**: 仮登記（順位保全）の対応は必要か？
