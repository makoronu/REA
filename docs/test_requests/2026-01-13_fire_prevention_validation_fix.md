# テスト依頼書: 防火地域バリデーション修正

## 作成日
2026-01-13

## 概要
「防火地域」フィールドで「指定なし」を選択してもバリデーションエラーが発生する問題を修正。

## 変更内容

| 変更対象 | 変更前 | 変更後 |
|---------|-------|-------|
| `fire_prevention_district` | バリデーション対象（required_for_publication = {land}） | バリデーション無効（NULL） |
| `fire_prevention_area` | バリデーション対象外 + shirokumaのみ表示 | 全物件種別でバリデーション対象 + 全ユーザーに表示 |

## 変更ファイル

| ファイル | 変更内容 |
|---------|---------|
| `scripts/migrations/fix_fire_prevention_validation.sql` | マイグレーションSQL |
| 本番DB `column_labels` | 2レコード更新 |

## テスト項目

### 正常系

| # | テスト内容 | 期待結果 | 確認 |
|---|----------|---------|------|
| 1 | 物件編集画面で「法令制限」タブを開く | 「防火地域」フィールドが表示される | [ ] |
| 2 | 「防火地域」で「防火地域」を選択して保存 | 保存成功 | [ ] |
| 3 | 「防火地域」で「準防火地域」を選択して保存 | 保存成功 | [ ] |
| 4 | 「防火地域」で「指定なし」を選択して保存 | 保存成功 | [ ] |
| 5 | 「指定なし」選択後、公開ステータスを「公開」に変更 | バリデーションエラーなしで保存成功 | [ ] |
| 6 | 「指定なし」選択後、公開ステータスを「会員公開」に変更 | バリデーションエラーなしで保存成功 | [ ] |

### 異常系

| # | テスト内容 | 期待結果 | 確認 |
|---|----------|---------|------|
| 7 | 「防火地域」を未選択のまま公開ステータスを「公開」に変更 | バリデーションエラー（防火地域が必須） | [ ] |
| 8 | 「防火地域」を未選択のまま公開ステータスを「会員公開」に変更 | バリデーションエラー（防火地域が必須） | [ ] |

### 物件種別別テスト

| # | 物件種別 | テスト内容 | 期待結果 | 確認 |
|---|---------|----------|---------|------|
| 9 | マンション | 「指定なし」選択後、公開に変更 | 成功 | [ ] |
| 10 | 戸建て | 「指定なし」選択後、公開に変更 | 成功 | [ ] |
| 11 | 土地 | 「指定なし」選択後、公開に変更 | 成功 | [ ] |

## テスト環境

- URL: https://realestateautomation.net/
- ユーザー: テスト用アカウント

## 備考

- `fire_prevention_district` は未使用フィールド（データ0件）のため無効化
- `fire_prevention_area` が実際に使用されているフィールド
