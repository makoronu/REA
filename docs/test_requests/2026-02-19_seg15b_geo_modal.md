# テスト依頼書: Seg 15b - Geoセクション モーダル化

**日付:** 2026-02-19
**対象コミット:** (未コミット)

---

## テスト対象

| ファイル | 変更内容 |
|----------|----------|
| DynamicForm.tsx | GeoSectionCard, GeoManagementModal 共通コンポーネント追加 |
| DynamicForm.tsx | StationAutoFetchButton: インライン展開 → コンパクトカード + 管理モーダル |
| DynamicForm.tsx | BusStopAutoFetchButton: 同上 |
| DynamicForm.tsx | FacilityAutoFetchButton: 同上 |
| DynamicForm.tsx | フォームレンダリング部分: h3見出し削除（カードに統合） |

---

## 変更概要

「所在地・周辺情報」タブの電車・鉄道/バス/周辺施設セクションを、インライン展開からコンパクトカード + 管理モーダル方式に変更。

- フォーム内: 各セクション1行のサマリーカード（アイコン + タイトル + 件数バッジ + 編集ボタン）
- 編集ボタン: 管理モーダルを開き、既存の登録リスト/追加/削除UIを表示
- スクロール量: ~1,300px → ~150px（約88%削減）

---

## テストケース

### 正常系

| # | テスト | 手順 | 期待結果 |
|---|--------|------|----------|
| 1 | 電車・鉄道カード表示 | 物件編集画面→所在地タブ | 「🚃 電車・鉄道 N件」のカードが表示 |
| 2 | 電車・鉄道編集 | カードの[編集]クリック | 管理モーダルが開き、登録済み駅リスト+追加ボタンが表示 |
| 3 | 駅追加 | モーダル内「最寄駅を追加」→駅選択 | SelectableListModalが管理モーダルの上に表示。駅選択後、管理モーダルのリストに反映 |
| 4 | 駅削除 | モーダル内の[削除]ボタン | リストから削除、カードの件数も更新 |
| 5 | 最寄駅なし | モーダル内チェックボックスON | カードに「最寄駅なし」と表示（黄色背景） |
| 6 | バスカード表示 | 所在地タブ確認 | 「🚌 バス N件」のカード表示 |
| 7 | バス停追加/削除 | テスト2-4と同様の操作 | 正常動作 |
| 8 | バス停なし | テスト5と同様 | 「バス停なし」表示 |
| 9 | 周辺施設カード表示 | 所在地タブ確認 | 「🏪 周辺施設 N件」のカード表示 |
| 10 | 施設追加/削除 | テスト2-4と同様の操作 | 正常動作 |
| 11 | 未設定表示 | 駅/バス/施設が0件の物件 | カードに「未設定」とグレーで表示 |
| 12 | モーダル閉じる | ×ボタン or オーバーレイクリック | モーダルが閉じる |
| 13 | 保存 | 編集後に保存 | 全データが正常に保存される |

### 攻撃ポイント

| # | 観点 | 確認内容 |
|---|------|----------|
| 14 | モーダルスタック | 管理モーダルの上にSelectableListModalが正しく表示されるか（z-index） |
| 15 | 学区セクション | 学区の自動取得ボタンは変更なし（従来通りインライン表示） |
| 16 | 他タブ | 所在地以外のタブに影響なし |
| 17 | レイアウト | カード3枚が縦に並び、コンパクトに表示されること |
| 18 | 自動保存 | モーダル内で変更→モーダルを閉じる→自動保存が発動すること |

---

## テスト環境

- フロント: `cd ~/my_programing/REA/rea-admin && npm run dev`
- API: `cd ~/my_programing/REA/rea-api && PYTHONPATH=~/my_programing/REA python -m uvicorn app.main:app --reload --port 8005`
- Geo API: `cd ~/my_programing/REA/rea-geo && PYTHONPATH=~/my_programing/REA python -m uvicorn app.main:app --reload --port 8007`
